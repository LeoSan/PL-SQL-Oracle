SELECT FNEMPNOMINA EMPLEADO
, TO_NUMBER(SUBSTR(FNEMPNOMINA, 2)) NUMEMPLEADO
, ( SELECT "nombreCompleto" FROM PENDUPM.VISTAASOCIADOS WHERE "cvetra" = TO_NUMBER(SUBSTR(FNEMPNOMINA, 2)) ) NOMBRE
, IDGASTO PLAN_DE_VIAJE
, FNMONTOGASTO MONTO
, TO_CHAR(FDFECINI,'DD-Mon-YY','nls_date_language=Spanish') FECHA_INICIO
, TO_CHAR(FDFECFIN,'DD-Mon-YY','nls_date_language=Spanish') FECHA_FIN 

FROM PENDUPM.GASTOMAIN
, (SELECT SUM(FNMONTOGASTO) TOTAL FROM PENDUPM.GASTOMAIN WHERE FCSTATUS IN ('A')) 

WHERE FCSTATUS IN ('A')  AND (FNMONTOGASTO IS NOT NULL AND FNMONTOGASTO > 0)
      AND FDDYNAMICSVIATICOS IS NULL 
     AND  IDGASTO = 4301272
        ORDER BY FDFECINI ASC